## 고루틴

### 뭘까

고루틴은 Go 프로그램 안에서 **동시에 독립적으로 실행되는 흐름의 단위**로, 스레드와 비슷한 개념이다. 

스레드와 달리 고루틴은 수 킬로바이트 정도의 **아주 적은 리소스에서 동작**하므로 한 프로레스에 수천, 수만개의 고루틴을 동작시킬 수 있다.

고루틴은 정보를 공유하는 방식이 아니라 **서로 메시지를 주고받는 방식**으로 동작한다. 따라서 **Lock으로 공유 메모리를 관리할 필요가 없다**.

<br>

다음은 go 키워드로 routine() 함수를 실행시켜서 새로운 고루틴을 만드는 과정이다.

```go
func routine(x, y string) int {
    // body
} 

func main() {
    go routine
    time.Sleep(untilRoutineEnd)
}
```

실행 중인 고루틴이 있어도 **메인 함수가 종료되면 프로그램이 종료**된다. 그래서 아직 **실행중인 고루틴이 있다면** 메인 함수가 **종료되지 않게 해야 한다**. 앞의 예제에서는 time.Sleep으로 고루틴의 종료를 대기하지만 고루틴이 얼마나 오랫동안 실행될지 알 수 없어서 효율적이지 않다.

Go에서는 메인 함수에서 고루틴의 **종료 상황을 확인할 수 있는 채널**을 만들고, 만든 채널을 통해 **종료 메시지를 대기**시키는 방법을 선호한다.

<br>